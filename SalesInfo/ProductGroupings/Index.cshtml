@page "/Salesinfo/ProductGroupings"
@model kamjaService.Pages.SalesInfo.ProductGroupings.IndexModel
@using System.IO;

@{
    ViewData["Title"] = "Index";
}
@{
    Layout = "/Pages/Shared/_Layout.cshtml";
}

<link href="~/css/swiper-bundle.min.css" rel="stylesheet" />
<div class="container">
    <h2>محصول</h2>
    <h5 style="margin-top: 15px;">توضیحات : </h5>
    <textarea id="desc_product_group" type="text" style="
                                margin-bottom: 5px;
                                padding-bottom: 27px;
                                border-radius: 2px;
                                overflow: hidden;
                                resize: none;
                                width: inherit;
                                height:50px"
              disabled>@Model.productGroupDescription
</textarea>
    <button class=" btn btn-secondary IranSansFont" id="readmore_btn" onclick="readMore()" style="margin-bottom: 23px;" data-readmore="1">بیشتر...</button>
    <form asp-page="./Index" method="get">
        <div class="form-actions no-color" style="margin-top:27px">
            <p>
                جستجو نام:
                <input type="hidden" name="id" value="@Model.gID" />
                <input type="text" name="SearchString" value="@Model.CurrentFilter" />
                <button type="submit" class="btn btn-danger"><h6 class="buttons_h6">جستجو</h6></button>

            </p>
        </div>
    </form>
</div>
<style>
 .tags {
    list-style: none;
    margin: 0;
    overflow: hidden;
    padding: 0;
}

    .tags li {
        float: left;
    }

.tag {
    background: #eee;
    border-radius: 3px 0 0 3px;
    color: #000;
    display: inline-block;
    height: 26px;
    line-height: 26px;
    padding: 0 20px 0 23px;
    position: relative;
    margin: 0 10px 10px 0;
    text-decoration: none;
    -webkit-transition: color 0.2s;
}

    .tag::before {
        background: #fff;
        border-radius: 10px;
        box-shadow: inset 0 1px rgba(0, 0, 0, 0.25);
        content: '';
        height: 6px;
        left: 10px;
        position: absolute;
        width: 6px;
        top: 10px;
    }

    .tag::after {
        background: #fff;
        border-bottom: 13px solid transparent;
        border-left: 10px solid #eee;
        border-top: 13px solid transparent;
        content: '';
        position: absolute;
        right: 0;
        top: 0;
    }

    .tag:hover {
        /*background-color: #dc3545;*/
        background-color: #d71921;
        text-decoration: none;
        color:white;

    }

        .tag:hover::after {
            border-left-color: #d71921;
        }

</style>

<div class="container-fluid">

    <div class="row">
        <div class="col-lg-6">

            <div class="card bg-light" style="margin-bottom:25px;min-height:200px;">
                <div class="card-body">
                    <h5 class="card-title">
                        کلیپ
                    </h5>
                    <div class="container-fluid">
                        <div class="row">
                            <div class="swiper clipSwiper">
                                <div class="swiper-wrapper">

                                    @{
                                        foreach (var clipsrc in Model.videoSrcList)
                                        {
                                            if (clipsrc != "wwwroot\\image\\no_image.png")
                                            {
                                                var clipsrc2 = clipsrc.Replace("wwwroot", "");
                                                <div class="swiper-slide" style="max-height:460px">

                                                    <video style="width: 100%;" disablePictureInPicture controls name="media">
                                                        <source src="@clipsrc2" type="video/mp4">
                                                    </video>
                                                </div>
                                            }
                                            else
                                            {
                                                <div class="swiper-slide" style="max-height:460px">
                                                    <img src="~/image/no_image.png" style="width:auto;max-height: 250px;cursor: pointer;" />
                                                </div>
                                            }
                                        }

                                    }

                                </div>
                                <div class="swiper-button-next"></div>
                                <div class="swiper-button-prev"></div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6" id="ProductGroupingImageGallery" style="max-height:460px !important">

            <div class="card bg-light" style="margin-bottom: 25px;min-height: 200px;">
                <div class="card-body">
                    <h5 class="card-title">
                        گالری تصاویر
                    </h5>
                    <div class="container-fluid">
                        <div class="row">
                            <!-- Swiper -->
                            <div class="swiper mySwiper">
                                <div class="swiper-wrapper">
                                    @{

                                        foreach (var imgsrc in Model.imageSrcList)
                                        {
                                            var imgsrc2 = imgsrc.Replace("wwwroot", "");

                                            <div class="swiper-slide" style="max-height:460px">
                                                <span id="zoomSliderImgOnClick" data-toggle="modal" data-target="#zoomSliderImageModal" data-value="@imgsrc2" onclick="zoomSliderImageFunc()">
                                                    <img src="@imgsrc2" style="width:auto;max-height: 250px;cursor: pointer;" />
                                                </span>
                                            </div>
                                        }
                                    }
                                </div>
                                <div class="swiper-button-next"></div>
                                <div class="swiper-button-prev"></div>
                                <div class="swiper-pagination"></div>

                            </div>

                        </div>
                    </div>


                </div>
            </div>
        </div>

    </div>
    <div class="row">
        @foreach (var item in Model.proColViews)
        {
            <div class="col-lg-6">
                <div class="card bg-light" style="margin-bottom:25px;">
                    <div class="card-body">
                        <h5 class="card-title">@Html.DisplayFor(modelItem => item.Name) (@Html.DisplayFor(modelItem => item.Number))</h5>
                        <div class="container">
                            <div class="row">
                                <div class="col-6" style="padding-right: 0px !important;">
                                    <div class="rounded border" style="
                                                        padding: 10px;

                                                        padding-right: 5px;
                                                        margin-right: 0px;
                                                        border-color: #991a2633 !important;">
                                        <div class="card-text">
                                            <h6  style="font-weight:bold">پایه چوبی: </h6>
                                            @if(@item.پایه != null) { 
                                                String[] payes = item.پایه.Split(",");
                                                <ul class="tags">
                                                @foreach(var colorCat in payes) {
                                                    <li>
                                                        <a class="colors_card tag" data-toggle="modal" data-target="#pgingColorsModal" onclick="getColors('@colorCat')" style="cursor:pointer;">
                                                            <span style="font-family: IRANSansWebFaNum">
                                                                @Html.DisplayFor(modelItem => colorCat)
                                                            </span>
                                                        </a>
                                                    </li>
                                                }
                                                </ul>
                                            }
                                        </div>
                                        <div class="card-text">
                                            <h6  style="font-weight:bold">بدنه: </h6>
                                            @if(@item.بدنه != null) { 
                                                String[] badanes = item.بدنه.Split(",");
                                                <ul class="tags">
                                                @foreach(var colorCat in badanes) {
                                                    <li>
                                                        <a class="colors_card tag" data-toggle="modal" data-target="#pgingColorsModal" onclick="getColors('@colorCat')" style="cursor:pointer;">
                                                            <span style="font-family: IRANSansWebFaNum">
                                                                @Html.DisplayFor(modelItem => colorCat)
                                                            </span>
                                                        </a>
                                                    </li>
                                                }
                                                </ul>
                                            }
                                        </div>
                                        <div class="card-text">
                                            <h6  style="font-weight:bold">نما: </h6>
                                            @if(@item.نما != null) { 
                                                String[] namas = item.نما.Split(",");
                                                <ul class="tags">
                                                @foreach(var colorCat in namas) {
                                                    <li>
                                                        <a class="colors_card tag" data-toggle="modal" data-target="#pgingColorsModal" onclick="getColors('@colorCat')" style="cursor:pointer;">
                                                            <span style="font-family: IRANSansWebFaNum">
                                                                @Html.DisplayFor(modelItem => colorCat)
                                                            </span>
                                                        </a>
                                                    </li>
                                                }
                                                </ul>
                                            }
                                        </div>
                                    </div>
                                </div>

                                <div class="col-6 productGroupingImgModal" data-toggle="modal" data-target="#zoomImageModal" data-value="@Html.DisplayFor(modelItem => item.Number)" onclick="zoomImage(@item.Number)">
                                @{
                                    if (System.IO.File.Exists("wwwroot\\image\\Product\\pic\\" + item.Number + ".jpg")) {
                                        <img class="card-img-top" src="/image/Product/pic/@(item.Number).jpg" id="img_@item.Number" style="cursor: pointer">
                                    }   
                                    else
                                    {
                                        <img src="~/image/no_image.png" style="width:inherit"/>
                                    }
                                }
                                </div>

                                <div data-toggle="modal" data-target="#productGroupingModal"
                                     data-value="@Html.DisplayFor(modelItem => item.Number)" onclick="openDimensionModal(@item.Number)" class="productGroupingImgModal">
                                    <h6 style="
                                            text-decoration: underline;
                                            color: cornflowerblue;
                                            cursor: pointer;
                                            font-size: large;
                                            margin-bottom: 15px;
                                            margin-top: 15px;
                                            ">
                                        ابعاد
                                    </h6>
                                </div>

                            </div>
                        </div>

                        <h6 class="card-text">
                            توضیحات:
                            <textarea type="text" style="   padding-bottom: 27px;
                                                        height: auto;
                                                        min-height: 100px;
                                                        width: 95%;
                                                        margin-top: 5px;"
                                      disabled>@Model.productGroupingexps.Where(x => x.ProductGroupingIdref == item.ProductGroupingId).Select(x => x.Pexp).FirstOrDefault()</textarea>
                        </h6>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<div style="display:none;" class="modal fade" id="productGroupingModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">ابعاد</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="col-12 col-sm-12 col-lg-12">
                    <img class="w-100 yimg" id="productGroupingModalImg" src="#">
                </div>

            </div>
            <div class="modal-footer col-12 col-sm-12 col-lg-12">
            </div>
        </div>
    </div>
</div>

<div style="display:none;" class="modal fade" id="zoomImageModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="col-12 col-sm-12 col-lg-12">
                    <img class="w-100 productImg" id="productGroupingModalMainImg" src="#">
                </div>

            </div>
            <div class="modal-footer col-12 col-sm-12 col-lg-12">
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="zoomSliderImageModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="col-12 col-sm-12 col-lg-12">
                    <img class="w-100 productImg" id="ZoomSliderModalImg" src="#">
                </div>

            </div>
            <div class="modal-footer col-12 col-sm-12 col-lg-12">
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="pgingColorsModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h6 id="colorsCardHeader" style="font-weight:bold"></h6>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row" id="colorsCardDiv">

                    </div>

                </div>

            </div>
            <div class="modal-footer col-12 col-sm-12 col-lg-12">
            </div>
        </div>
    </div>
</div>

<script src="~/lib/jquery/dist/jquery.js"></script>
<script src="~/js/swiper-bundle-min.js"></script>
<script>

    function openDimensionModal(code) {
        var image = document.getElementById('productGroupingModalImg');
        image.setAttribute('src', '/image/dimensions/' + code + '.jpg')
    }

    function zoomImage(code) {
        var image = document.getElementById('productGroupingModalMainImg');
        image.setAttribute('src', '/image/Product/pic/' + code + '.jpg')
    }

    $(document).ready(function () {
        $('.swiper-slide-active #zoomSliderImgOnClick').click(function () {
            //debugger;
            var src = this.getAttribute('data-value');
            var image = document.getElementById('SliderModalImg');
            image.setAttribute('src', src)
        })
    })
    //< !--Initialize Swiper-- >
    var swiper = new Swiper(".mySwiper", {
        spaceBetween: 30,
        effect: "fade",
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
        },
    });

    var swiper = new Swiper(".clipSwiper", {
        cssMode: true,
        slidesPerView: 1,
        spaceBetween: 30,

        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        pagination: {
            el: ".swiper-pagination",
        },
    });

    function zoomSliderImageFunc() {
        var src = document.querySelector('#ProductGroupingImageGallery .swiper-slide-active img').getAttribute('src');
        var image = document.getElementById('ZoomSliderModalImg');
        image.setAttribute('src', src);
        //var header = document.getElementById('colorImageModalHeader');
        //header.innerText = colorName;
        //
    }

    function getColors(colorCatName) {
        $.ajax({
            type: "GET",
            url: '@Url.Page("index", "colors")',

            data: {
                colorCatName: colorCatName,
            },

            success: function (data) {
                var Container = document.getElementById("colorsCardDiv");
                Container.innerHTML = '';
                document.getElementById('colorsCardHeader').innerHTML = colorCatName
                $.each(data, function(key, value) {
                    var bootstrapDiv = document.createElement('div');
                    bootstrapDiv.className = "col-lg-4 col-md-4 col-6";
                    bootstrapDiv.style = "margin-bottom:18px";
                    Container.appendChild(bootstrapDiv);

                    var header = document.createElement("h6");
                    header.innerHTML = value;
                    bootstrapDiv.appendChild(header);

                    var img = document.createElement("img");
                    img.src = "\\image\\colors\\" + value + ".jpg";
                    img.style = "width :100px;height:100px;cursor:pointer";
                    bootstrapDiv.appendChild(img);

                    
                });

            }
        });

        
    }

</script>